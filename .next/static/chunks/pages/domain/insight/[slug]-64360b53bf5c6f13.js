(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[671],{8658:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/domain/insight/[slug]",function(){return t(4491)}])},4491:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return Z}});var n=t(5893),r=t(7294),i=t(9008),o=t.n(i),a=t(1163),l=t(1365),d=t(4539),c=t(9401),m=t(1917),u=t(602),x=t(9338),g=t(5057),p=t(2),h=t(6733),f=t(6566),y=t(9815),v=t(6501),b=function(e){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"clicks",t=s,n=[];switch(t){case"clicks":n=e.sort((function(e,s){return s.clicks>e.clicks?1:-1}));break;case"impressions":n=e.sort((function(e,s){return s.impressions>e.impressions?1:-1}));break;case"position":n=e.sort((function(e,s){return s.position>e.position?1:-1}));break;default:n=e}return n},w=t(5924),j=t(5158),N=t(1015),k=t(5686),_=function(e){var s=e.item,t=e.lastItem,r=e.type,i=e.domain,o=s.clicks,a=s.impressions,l=s.ctr,d=s.position,c=s.country,m=void 0===c?"zzz":c,u=s.keyword,x=s.page,g=s.keywords,p=void 0===g?0:g,h=s.countries,f=void 0===h?0:h,y=s.date,v=u;return"pages"===r&&(v=x),"stats"===r&&(v=y&&new Intl.DateTimeFormat("en-US",{dateStyle:"medium"}).format(new Date(y))),"countries"===r&&(v=j.ZP[m]&&j.ZP[m][0]),(0,n.jsxs)("div",{className:"keyword relative py-5 px-4 text-gray-600 border-b-[1px] border-gray-200 lg:py-4 lg:px-6 lg:border-0 \n      lg:flex lg:justify-between lg:items-center ".concat(t?"border-b-0":""),children:[(0,n.jsxs)("div",{className:" w-3/4 lg:flex-1 lg:basis-20 lg:w-auto font-semibold",children:["countries"===r&&(0,n.jsx)("span",{className:"fflag fflag-".concat(m," w-[18px] h-[12px] mr-2")}),"pages"===r&&i?(0,n.jsx)("a",{href:"https://".concat(i).concat(x),target:"_blank",rel:"noreferrer",children:v}):v]}),(0,n.jsxs)("div",{className:"keyword_pos text-center inline-block mr-3 lg:mr-0 lg:flex-1",children:[(0,n.jsx)("span",{className:"mr-1 lg:hidden",children:(0,n.jsx)(N.Z,{type:"tracking",size:14,color:"#999"})}),Math.round(d)]}),(0,n.jsxs)("div",{className:"keyword_position absolute bg-[#f8f9ff] w-fit min-w-[50px] h-14 p-2 text-base mt-[-55px] rounded right-5 lg:relative\n          lg:bg-transparent lg:w-auto lg:h-auto lg:mt-0 lg:p-0 lg:text-sm lg:flex-1 lg:basis-40 lg:grow-0 lg:right-0 text-center font-semibold",children:[(0,k.y)(o),(0,n.jsx)("span",{className:"block text-xs text-gray-500 lg:hidden",children:"Visits"})]}),(0,n.jsxs)("div",{className:"keyword_imp text-center inline-block mr-3 lg:mr-0 lg:flex-1",children:[(0,n.jsx)("span",{className:"mr-1 lg:hidden",children:(0,n.jsx)(N.Z,{type:"eye",size:14,color:"#999"})}),(0,k.y)(a)]}),(0,n.jsxs)("div",{className:"keyword_ctr text-center inline-block mt-4 relative mr-3 lg:mr-0 lg:flex-1 lg:m-0 ",children:[(0,n.jsx)("span",{className:"mr-1 lg:hidden",children:(0,n.jsx)(N.Z,{type:"target",size:14,color:"#999"})}),new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(l),"%"]}),("pages"===r||"keywords"===r)&&(0,n.jsx)("div",{className:"keyword_imp text-center hidden lg:inline-block lg:flex-1",children:(0,k.y)(f)}),("countries"===r||"pages"===r)&&(0,n.jsx)("div",{className:"keyword_imp text-center hidden lg:inline-block lg:flex-1",children:(0,k.y)(p)})]})},D=t(9175),C=t(5376);D.kL.register(D.uw,D.f$,D.od,D.jn,D.Dx,D.u,D.De);var S=function(e){var s=e.stats,t=void 0===s?[]:s,i=e.totalKeywords,o=void 0===i?0:i,a=e.totalPages,l=void 0===a?0:a,d=(0,r.useMemo)((function(){return t.reduce((function(e,s){return{impressions:s.impressions+e.impressions,clicks:s.clicks+e.clicks,ctr:s.ctr+e.ctr,position:s.position+e.position}}),{impressions:0,clicks:0,ctr:0,position:0})}),[t]),c=(0,r.useMemo)((function(){var e=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],s={clicks:[],impressions:[],position:[],ctr:[]};return t.forEach((function(e){s.clicks.push(e.clicks),s.impressions.push(e.impressions),s.position.push(e.position),s.ctr.push(e.ctr)})),{labels:t&&t.length>0?t.map((function(s){return"".concat(new Date(s.date).getDate(),"-").concat(e[new Date(s.date).getMonth()])})):[],series:s}}),[t]);return(0,n.jsxs)("div",{className:"p-6 lg:border-t lg:border-gray-200",children:[(0,n.jsxs)("div",{className:" flex font-bold flex-wrap lg:flex-nowrap",children:[(0,n.jsxs)("div",{className:"flex-1 border border-gray-200 px-6 py-5 rounded mb-4 text-2xl text-violet-700 mr-5",title:"".concat((0,k.y)(d.clicks||0)," Visits"),children:[(0,n.jsx)("span",{className:" block text-sm font-normal text-gray-500",children:"Visits"}),new Intl.NumberFormat("en-US",{notation:"compact",compactDisplay:"short"}).format(d.clicks||0).replace("T","K")]}),(0,n.jsxs)("div",{className:"flex-1 border border-gray-200 px-6 py-5 rounded mb-4 text-2xl text-[#1fcdb0] lg:mr-5",title:"".concat((0,k.y)(d.impressions||0)," Impressions"),children:[(0,n.jsx)("span",{className:" block text-sm font-normal text-gray-500",children:"Impressions"}),new Intl.NumberFormat("en-US",{notation:"compact",compactDisplay:"short"}).format(d.impressions||0).replace("T","K")]}),(0,n.jsxs)("div",{className:"flex-1 border border-gray-200 px-6 py-5 rounded mb-4 text-2xl text-gray-500 font-semibold mr-5",children:[(0,n.jsx)("span",{className:" block text-sm font-normal text-gray-500",children:"Avg Position"}),d.position?Math.round(d.position/t.length):0]}),(0,n.jsxs)("div",{className:"flex-1 border border-gray-200 px-6 py-5 rounded mb-4 text-2xl text-gray-500 font-semibold lg:mr-5",children:[(0,n.jsx)("span",{className:" block text-sm font-normal text-gray-500",children:"Avg CTR"}),new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(d.ctr||0),"%"]}),(0,n.jsxs)("div",{className:"flex-1 border border-gray-200 px-6 py-5 rounded mb-4 text-2xl text-gray-500 font-semibold mr-5",children:[(0,n.jsx)("span",{className:" block text-sm font-normal text-gray-500",children:"Keywords"}),(0,k.y)(o)]}),(0,n.jsxs)("div",{className:"flex-1 border border-gray-200 px-6 py-5 rounded mb-4 text-2xl text-gray-500 font-semibold",children:[(0,n.jsx)("span",{className:" block text-sm font-normal text-gray-500",children:"Pages"}),(0,k.y)(l)]})]}),(0,n.jsx)("div",{className:"h-80",children:function(){var e=c.series||{},s=[{label:"Visits",data:e.clicks,borderColor:"rgb(117, 50, 205)",backgroundColor:"rgba(117, 50, 205, 0.5)",yAxisID:"y"},{label:"Impressions",data:e.impressions,borderColor:"rgb(31, 205, 176)",backgroundColor:"rgba(31, 205, 176, 0.5)",yAxisID:"y1"}];return(0,n.jsx)(C.x1,{datasetIdKey:"xxx",options:{responsive:!0,maintainAspectRatio:!1,animation:!1,interaction:{mode:"index",intersect:!1},scales:{x:{grid:{drawOnChartArea:!1}},y1:{display:!0,position:"right",grid:{drawOnChartArea:!1}}},plugins:{legend:{display:!1}}},data:{labels:c.labels,datasets:s}})}()})]})},F=function(e){var s,t,i,o=e.insight,a=e.isLoading,l=void 0===a||a,d=e.isConsoleIntegrated,c=void 0===d||d,m=e.domain,u=(0,r.useState)("stats"),x=u[0],g=u[1],p=o[x],h=o&&o.stats&&o.stats.length>0?new Date(o.stats[0].date):null,f=o&&o.stats&&o.stats.length>0?new Date(o.stats[o.stats.length-1].date):null,j=function(e){g(e)};return(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"domKeywords flex flex-col bg-[white] rounded-md text-sm border mb-5",children:[(0,n.jsxs)("div",{className:"domKeywords_filters py-4 px-6 flex flex-col justify-between text-sm text-gray-500 font-semibold border-b-[1px] lg:border-0 lg:flex-row",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("ul",{className:"text-xs hidden lg:flex",children:["stats","keywords","countries","pages"].map((function(e){var s=o[e];return(0,n.jsxs)("li",{className:"".concat("select-none cursor-pointer px-3 py-2 rounded-3xl mr-2"," ").concat(x===e?" bg-[#F8F9FF] text-gray-700":""),onClick:function(){return j(e)},children:[(0,n.jsx)("i",{className:"hidden not-italic lg:inline-block ml-1 capitalize",children:e}),"stats"!==e&&(0,n.jsx)("span",{className:"".concat("px-2 py-0 rounded-3xl bg-[#DEE1FC] text-[0.7rem] font-bold ml-1"),children:s&&s.length?s.length:0})]},"tab-".concat(e))}))}),(0,n.jsx)("div",{className:"insight_selector lg:hidden",children:(0,n.jsx)(w.Z,{options:["stats","keywords","countries","pages"].map((function(e){return{label:e,value:e}})),selected:[x],defaultLabel:"Select Tab",updateField:function(e){return j(e[0])},multiple:!1,rounded:"rounded"})})]}),c&&(0,n.jsxs)("div",{className:"py-2 text-xs text-center mt-2 lg:text-sm lg:mt-0",children:[h&&new Intl.DateTimeFormat("en-US",{dateStyle:"medium"}).format(new Date(h)),(0,n.jsx)("span",{className:"px-2 inline-block",children:"-"}),f&&new Intl.DateTimeFormat("en-US",{dateStyle:"medium"}).format(new Date(f)),(0,n.jsx)("span",{className:"ml-2",children:"(Last 30 Days)"})]})]}),c&&"stats"===x&&(0,n.jsx)(S,{stats:(null===o||void 0===o?void 0:o.stats)?o.stats:[],totalKeywords:(null===o||void 0===o||null===(s=o.keywords)||void 0===s?void 0:s.length)||0,totalCountries:(null===o||void 0===o||null===(t=o.countries)||void 0===t?void 0:t.length)||0,totalPages:(null===o||void 0===o||null===(i=o.pages)||void 0===i?void 0:i.length)||0}),(0,n.jsx)("div",{className:"domkeywordsTable domkeywordsTable--sckeywords styled-scrollbar w-full overflow-auto min-h-[60vh]",children:(0,n.jsxs)("div",{className:" lg:min-w-[800px]",children:[function(){var e={stats:["Date","Avg Position","Visits","Impressions","CTR"],keywords:["Keyword","Avg Position","Visits \u2191","Impressions","CTR","Countries"],countries:["Country","Avg Position","Visits \u2191","Impressions","CTR","Keywords"],pages:["Page","Avg Position","Visits \u2191","Impressions","CTR","Countries","Keywords"]};return(0,n.jsxs)("div",{className:"domKeywords_head hidden lg:flex p-3 px-6 bg-[#FCFCFF]\n            text-gray-600 justify-between items-center font-semibold border-y",children:[(0,n.jsx)("span",{className:"domKeywords_head_keyword flex-1 basis-20 w-auto ",children:e[x][0]}),(0,n.jsx)("span",{className:"domKeywords_head_position flex-1 basis-40 grow-0 text-center",children:e[x][1]}),(0,n.jsx)("span",{className:"domKeywords_head_imp flex-1 text-center",children:e[x][2]}),(0,n.jsx)("span",{className:"domKeywords_head_visits flex-1 text-center",children:e[x][3]}),(0,n.jsx)("span",{className:"domKeywords_head_ctr flex-1 text-center",children:e[x][4]}),e[x][5]&&(0,n.jsx)("span",{className:"domKeywords_head_ctr flex-1 text-center",children:e[x][5]}),e[x][6]&&(0,n.jsx)("span",{className:"domKeywords_head_ctr flex-1 text-center",children:e[x][6]})]})}(),(0,n.jsxs)("div",{className:"domKeywords_keywords border-gray-200 min-h-[55vh] relative",children:[["keywords","pages","countries","stats"].includes(x)&&o&&p&&("stats"===x?(0,y.Z)(p).reverse():b(p)).map((function(e,s){var t=o?p:[],r=!(!t||s!==t.length);return(0,n.jsx)(_,{item:e,type:x,lastItem:r,domain:(null===m||void 0===m?void 0:m.domain)||""},s)})),c&&l&&(0,n.jsx)("p",{className:" p-9 pt-[10%] text-center text-gray-500",children:"Loading Insight..."}),!c&&(0,n.jsxs)("p",{className:" p-9 pt-[10%] text-center text-gray-500",children:["Google Search Console has not been Integrated yet. Please follow ",(0,n.jsx)("a",{className:"text-indigo-600 underline",href:"https://docs.serpbear.com/miscellaneous/integrate-google-search-console",target:"_blank",rel:"noreferrer",children:"These Steps"})," to integrate Google Search Data for this Domain."]})]})]})})]}),(0,n.jsx)(v.x7,{position:"bottom-center",containerClassName:"react_toaster"})]})},I=t(9870),K=t(1602),Z=function(){var e,s,t,i=(0,a.useRouter)(),y=(0,r.useState)(!1),v=y[0],b=y[1],w=(0,r.useState)(!1),j=w[0],N=w[1],k=(0,r.useState)(!1),_=k[0],D=k[1],C=(0,r.useState)("thirtyDays"),S=C[0],Z=C[1],E=(0,I.pX)().data,T=(0,h.fW)(i).data,A=!(!E||!(null===E||void 0===E||null===(e=E.settings)||void 0===e?void 0:e.search_console_integrated)),M=(0,f.DL)(i,!!(null===T||void 0===T||null===(s=T.domains)||void 0===s?void 0:s.length)&&A).data,P=T&&T.domains||[],O=M&&M.data?M.data:{},z=(0,r.useMemo)((function(){var e,s=null;return(null===T||void 0===T?void 0:T.domains)&&(null===(e=i.query)||void 0===e?void 0:e.slug)&&(s=T.domains.find((function(e){return e.slug===i.query.slug}))||null),s}),[i.query.slug,T]),U=(0,r.useMemo)((function(){var e=(null===z||void 0===z?void 0:z.search_console)?JSON.parse(z.search_console):{};return!(!(null===e||void 0===e?void 0:e.client_email)||!(null===e||void 0===e?void 0:e.private_key))}),[z]);return(0,n.jsxs)("div",{className:"Domain ",children:[z&&z.domain&&(0,n.jsx)(o(),{children:(0,n.jsxs)("title",{children:["".concat(z.domain," - ZeniBot")," "]})}),(0,n.jsx)(c.Z,{showSettings:function(){return N(!0)},showAddModal:function(){return D(!0)}}),(0,n.jsxs)("div",{className:"flex w-full mx-auto",children:[(0,n.jsx)(d.Z,{domains:P,showAddModal:function(){return D(!0)}}),(0,n.jsxs)("div",{className:"domain_kewywords px-16 pt-20 lg:px-8 lg:pt-16 w-full",children:[z&&z.domain?(0,n.jsx)(m.Z,{domain:z,domains:P,showAddModal:function(){return console.log("XXXXX")},showSettingsModal:b,exportCsv:function(){return(0,g.Z)([],z.domain,S)},scFilter:S,setScFilter:function(e){return Z(e)}}):(0,n.jsx)("div",{className:"w-full lg:h-[100px]"}),(0,n.jsx)(F,{isLoading:!1,domain:z,insight:O,isConsoleIntegrated:A||U})]})]}),(0,n.jsx)(l.Z,{in:_,timeout:300,classNames:"modal_anim",unmountOnExit:!0,mountOnEnter:!0,children:(0,n.jsx)(u.Z,{closeModal:function(){return D(!1)},domains:(null===T||void 0===T?void 0:T.domains)||[]})}),(0,n.jsx)(l.Z,{in:v,timeout:300,classNames:"modal_anim",unmountOnExit:!0,mountOnEnter:!0,children:(0,n.jsx)(x.Z,{domain:!!(v&&P&&z&&z.domain)&&z,closeModal:b})}),(0,n.jsx)(l.Z,{in:j,timeout:300,classNames:"settings_anim",unmountOnExit:!0,mountOnEnter:!0,children:(0,n.jsx)(p.Z,{closeSettings:function(){return N(!1)}})}),(0,n.jsx)(K.Z,{currentVersion:(null===E||void 0===E||null===(t=E.settings)||void 0===t?void 0:t.version)?E.settings.version:""})]})}},6566:function(e,s,t){"use strict";t.d(s,{DL:function(){return m},aK:function(){return l}});var n=t(7568),r=t(7582),i=t(8767);function o(e){return a.apply(this,arguments)}function a(){return(a=(0,n.Z)((function(e){var s;return(0,r.__generator)(this,(function(t){switch(t.label){case 0:return[4,fetch("".concat(window.location.origin,"/api/searchconsole?domain=").concat(e.query.slug),{method:"GET"})];case 1:if((s=t.sent()).status>=400&&s.status<600)throw 401===s.status&&(console.log("Unauthorized!!"),e.push("/login")),new Error("Bad response from server");return[2,s.json()]}}))}))).apply(this,arguments)}function l(e){var s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(0,i.useQuery)("sckeywords",(function(){return e.query.slug&&o(e)}),{enabled:s})}function d(e){return c.apply(this,arguments)}function c(){return(c=(0,n.Z)((function(e){var s;return(0,r.__generator)(this,(function(t){switch(t.label){case 0:return[4,fetch("".concat(window.location.origin,"/api/insight?domain=").concat(e.query.slug),{method:"GET"})];case 1:if((s=t.sent()).status>=400&&s.status<600)throw 401===s.status&&(console.log("Unauthorized!!"),e.push("/login")),new Error("Bad response from server");return[2,s.json()]}}))}))).apply(this,arguments)}function m(e){var s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(0,i.useQuery)("scinsight",(function(){return e.query.slug&&d(e)}),{enabled:s})}}},function(e){e.O(0,[757,358,389,15,971,726,594,774,888,179],(function(){return s=8658,e(e.s=s);var s}));var s=e.O();_N_E=s}]);